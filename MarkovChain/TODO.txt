- remove duplication between the two lookUp functions
- factor out the two markovChain functions
